<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
	<link href="Style/core.css" rel="stylesheet" type="text/css" />
	<link href="Style/testreg.css" rel="stylesheet" type="text/css" />
	<style type="text/css">
.adminForm {
	margin: auto;
	width: 1024px;
}

.adminForm>ul {
	list-style-type: none;
}

.adminForm li {
	line-height: 2em;
}

.adminForm label {
	display: inline-block;
	width: 200px;
	margin: 0 1em 0 0;
}

.adminForm li>input, .adminForm select, .adminForm textarea {
	min-width: 200px;
	margin: 0 1em 0 0;
}

.checkHolder {
	display: inline-block;
}

.adminForm legend {
	display: none;
}

.adminForm fieldset {
	display: inline;
	line-height: 1;
	vertical-align: middle;
}

.checkHolder label {
	margin-left: 0;
	margin-right: 20px;
	width: auto;
}

.adminForm button {
	margin-left: 257px;
}
/*Table style Overrides*/
.ui-widget-header {
	background: #3db11a none repeat scroll 0 0;
	border: 1px solid #e4e4e4;
	color: #ffffff;
}

.ui-state-default, .ui-widget-content .ui-state-default,
	.ui-widget-header .ui-state-default {
	background: rgba(255, 255, 255, 0.52)
		-moz-linear-gradient(center top, rgba(255, 255, 255, 0.2),
		rgba(255, 255, 255, 0)) repeat scroll 0 0;
	background: rgba(255, 255, 255, 0.52)
		-webkit-linear-gradient(center top, rgba(255, 255, 255, 0.2),
		rgba(255, 255, 255, 0)) repeat scroll 0 0;
	background: rgba(255, 255, 255, 0.52)
		linear-gradient(center top, rgba(255, 255, 255, 0.2),
		rgba(255, 255, 255, 0)) repeat scroll 0 0;
	border: 1px solid #3DB11A;
}
</style>
	<title>TDS Admin Home Page</title>
</h:head>

<h:body>
	<div class="container">
		<a target="_self" href="#mainContent" data-ng-click="#mainContent"
			class="skipToContent" id="skipNavigation">Skip to Main Content</a>
		<div class="header">
			<div class="info ng-scope">
				<ul>
					<li>Logged in as: ${userBean.getFullName()}</li>
					<li><a href="saml/logout">Logout</a></li>
				</ul>
			</div>
			<div class="banner ng-scope">
				<span class="logo"><a tabindex="0" href="#"><img
						name="SBAC_logo" alt="Logo" class="thumbnail"
						data-ng-src="https://tr.ci.opentestsystem.org:8443/resources/testreg/images/logo_sbac.png"
						src="https://tr.ci.opentestsystem.org:8443/resources/testreg/images/logo_sbac.png" /></a></span>
				<div class="title">
					<h1>TDS Administration</h1>
				</div>
				<div class="clear"></div>
			</div>
		</div>
	</div>
	<div id="mainContent" class="content">
		<div class="secContent">
			<c:choose>
				<c:when
					test="#{userBean.getUser().hasPermission('ROLE_Opportunity Read') or userBean.getUser().hasPermission('ROLE_Opportunity Modify') }">
					<h:form>
						<h:selectOneMenu id="procedure"
							value="#{defaultBacking.procedure}"
							valueChangeListener="#{defaultBacking.procedureChange()}"
							onchange="submit()">
							<f:selectItems value="#{defaultBacking.procedures.entrySet()}"
								var="entry" itemValue="#{entry.key}" itemLabel="#{entry.value}"></f:selectItems>
						</h:selectOneMenu>
						<br />
						<br />

						<h:outputLabel value="Student ID"></h:outputLabel>
						<h:inputText id="essid" value="#{defaultBacking.extssid}"
							maxlength="40" binding="#{studentid}">
							<f:validator validatorId="tdsValidator" />
						</h:inputText>
						<h:message for="essid" style="color:red"></h:message>
						<h:selectOneRadio value="#{defaultBacking.radiossid}"
							layout="pageDirection">
							<f:selectItem itemValue="ssid" itemLabel="Use SSID" />
							<f:selectItem itemValue="extssid" itemLabel="Use External SSID" />
						</h:selectOneRadio>
						<h:outputText value="#{defaultBacking.selectRadioText}"
							style="color:red"></h:outputText>
						<h:outputText value="&#160;" />
						<h:outputText value="&#160;" />
						<h:outputText value="&#160;" />
						<h:outputLabel value="Session ID"></h:outputLabel>
						<h:inputText id="session" binding="#{sessionid}" maxlength="40"
							value="#{defaultBacking.sessionid}">
							<f:validator validatorId="tdsValidator" style="color:red" />
						</h:inputText>
						<h:message for="session" style="color:red"></h:message>
						<br />
						<br />
						<h:commandButton type="submit" id="search"
							actionListener="#{defaultBacking.searchOpportunity(studentid.value,sessionid.value)}"
							style="horizontal-align:middle;" value="Search for Opportunities"></h:commandButton>
						<h:outputText value="#{defaultBacking.selectIdText}"
							style="color:red"></h:outputText>
						<br />
						<br />
						<br />

						<h:outputText value="#{defaultBacking.executionResult}"
							style="color:green"></h:outputText>
						<h:outputText value="#{defaultBacking.nomatch}" style="color:red"></h:outputText>
						<p:dataTable value="#{defaultBacking.lazyOpps}" var="opp"
							id="mytable" rendered="#{defaultBacking.oppCount>0}"
							selectionMode="single" paginator="true" rows="5" lazy="true"
							tableStyle="table-layout:auto;" resizableColumns="true"
							editable="true" rowIndexVar="index"
							paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							rowsPerPageTemplate="5,10,15">
							<p:column>
								<h:selectBooleanCheckbox value="#{opp.selected}"
									onchange="submit()">
								</h:selectBooleanCheckbox>
							</p:column>
							<p:column sortBy="altSsid">
								<f:facet name="header">Ext.SSID</f:facet>
    				#{opp.altSsid}
    			</p:column>
							<p:column sortBy="name">
								<f:facet name="header">Name</f:facet>
    				#{opp.name}
    			</p:column>
							<p:column sortBy="testName">
								<f:facet name="header">Test Name</f:facet>
								<h:outputText id="subject" value="#{opp.subject}"></h:outputText>
								<p:tooltip id="subjecttip" for="subject" value="#{opp.testName}"></p:tooltip>
							</p:column>
							<p:column sortBy="sessionId">
								<f:facet name="header">Session ID</f:facet>
    				#{opp.sessionId}
    			</p:column>
							<p:column sortBy="status">
								<f:facet name="header">Status</f:facet>
    				#{opp.status}
    			</p:column>
							<p:column sortBy="dateStarted">
								<f:facet name="header">Started On</f:facet>
								<h:outputText value="#{opp.dateStarted}">
									<f:convertDateTime pattern="dd-MMM-yyyy" />
								</h:outputText>
							</p:column>
							<p:column sortBy="dateExpired">
								<f:facet name="header">Expired On</f:facet>
								<h:outputText value="#{opp.dateExpired}">
									<f:convertDateTime pattern="dd-MMM-yyyy" />
								</h:outputText>
							</p:column>
							<p:column sortBy="dateCompleted">
								<f:facet name="header">Completed On</f:facet>
								<h:outputText value="#{opp.dateCompleted}">
									<f:convertDateTime pattern="dd-MMM-yyyy" />
								</h:outputText>
							</p:column>
							<p:column sortBy="datePaused">
								<f:facet name="header">Paused On</f:facet>
								<h:outputText value="#{opp.datePaused}">
									<f:convertDateTime pattern="dd-MMM-yyyy" />
								</h:outputText>
							</p:column>
							<p:column sortBy="restart">
								<f:facet name="header">Restarts</f:facet>
    				#{opp.restart}
    			</p:column>
							<p:column sortBy="segmentPosition"
								rendered='#{"changeperm".equals(defaultBacking.procedure)}'>
								<f:facet name="header">Segment Position</f:facet>
    				#{opp.segmentPosition}
    			</p:column>
							<p:column
								rendered='#{"changeperm".equals(defaultBacking.procedure)}'>
								<f:facet name="header">Permeable</f:facet>
								<h:selectBooleanCheckbox value="#{opp.permeable}" />
							</p:column>
							<p:column sortBy="segmentName"
								rendered='#{"changeperm".equals(defaultBacking.procedure)}'>
								<f:facet name="header">Segment Name</f:facet>
    				#{opp.segmentName}
    			</p:column>
							<p:column rendered='#{"extend".equals(defaultBacking.procedure)}'>
								<f:facet name="header">SelectedSitting</f:facet>
								<h:inputText value="#{opp.selectedSitting}" onchange="submit()"
									onkeypress="if(event.which &lt; 48 || event.which &gt; 57) return false;">
								</h:inputText>
							</p:column>
							<p:column rendered='#{"alter".equals(defaultBacking.procedure)}'>
								<f:facet name="header">DayIncrement</f:facet>
								<h:inputText value="#{opp.dayIncrement}" onchange="submit()"
									onkeypress="if(event.which &lt; 48 || event.which &gt; 57) return false;">
								</h:inputText>
							</p:column>
							<p:column
								rendered='#{"changeperm".equals(defaultBacking.procedure)}'>
								<f:facet name="header">Restore On</f:facet>
								<h:selectOneMenu value="#{opp.restoreOn}">
									<f:selectItem itemLabel="Segment" itemValue="segment"></f:selectItem>
									<f:selectItem itemLabel="Paused" itemValue="paused"></f:selectItem>
									<f:selectItem itemLabel="Completed" itemValue="completed"></f:selectItem>
								</h:selectOneMenu>
							</p:column>
							<p:column sortBy="result">
								<f:facet name="header">Result</f:facet>
								<h:outputText value="#{opp.result}" id="result"
									style="#{defaultBacking.getStyle(opp.result)}">
								</h:outputText>
								<p:tooltip id="mytooltip" for="result" value="#{opp.reason}"></p:tooltip>
							</p:column>

						</p:dataTable>

						<h:outputLabel>Reason</h:outputLabel>
						<h:inputTextarea value="#{defaultBacking.reason}"></h:inputTextarea>
						<h:commandButton type="submit" id="executeProcedure"
							disabled="#{defaultBacking.executeDisabled}"
							actionListener="#{defaultBacking.execute()}"
							style="horizontal-align:middle;"
							value="Execute Procedure on Selected Opportunities"></h:commandButton>
					</h:form>
				</c:when>
				<c:otherwise>
					<h:outputText style="color:red">You don't have permission to view this page</h:outputText>
				</c:otherwise>
			</c:choose>
		</div>
	</div>

	<div class="footer ng-scope">
		<div class="footerText ng-binding" data-ng-if="buildInfo.appVersion">
			Version: 0.0.1-SNAPSHOT <span
				data-ng-show="buildInfo.jenkinsBuildNumber" class="ng-binding">
				(build #: 85)</span>
		</div>
	</div>
</h:body>
</html>
